# Professional Prosody XMPP Server Environment Configuration
# Copy this file to .env and customize for your deployment

# ============================================================================
# BASIC CONFIGURATION
# ============================================================================

# Your XMPP domain (REQUIRED)
PROSODY_DOMAIN=example.com

# Administrator accounts (comma-separated)
PROSODY_ADMINS=admin@example.com,support@example.com

# ============================================================================
# FEATURE TOGGLES
# ============================================================================

# Security features (recommended: true)
PROSODY_ENABLE_SECURITY=true

# Modern XMPP features (recommended: true)
PROSODY_ENABLE_MODERN=true

# HTTP services (BOSH, WebSocket, file upload)
PROSODY_ENABLE_HTTP=false

# Administration interface
PROSODY_ENABLE_ADMIN=false

# Enterprise features (monitoring, compliance)
PROSODY_ENABLE_ENTERPRISE=false

# ============================================================================
# REGISTRATION SETTINGS
# ============================================================================

# Allow user registration (recommended: false for production)
PROSODY_ALLOW_REGISTRATION=false

# ============================================================================
# DATABASE CONFIGURATION
# ============================================================================

# Storage backend: sqlite or sql
PROSODY_STORAGE=sqlite

# Database settings (only for PROSODY_STORAGE=sql)
PROSODY_DB_DRIVER=PostgreSQL
PROSODY_DB_HOST=db
PROSODY_DB_PORT=5432
PROSODY_DB_NAME=prosody
PROSODY_DB_USER=prosody
PROSODY_DB_PASSWORD=secure_password_here

# Database connection pooling
PROSODY_DB_POOL_SIZE=5
PROSODY_DB_MAX_CONNECTIONS=20
PROSODY_DB_TIMEOUT=30

# ============================================================================
# PERFORMANCE SETTINGS
# ============================================================================

# Client connection rate limiting
PROSODY_C2S_RATE=10kb/s
PROSODY_C2S_BURST=25kb

# Server connection rate limiting
PROSODY_S2S_RATE=30kb/s
PROSODY_S2S_BURST=100kb

# Garbage collection settings
PROSODY_GC_MODE=incremental
PROSODY_GC_THRESHOLD=150
PROSODY_GC_SPEED=500

# ============================================================================
# LOGGING CONFIGURATION
# ============================================================================

# Log level: debug, info, warn, error
PROSODY_LOG_LEVEL=info

# Log format: default or json
PROSODY_LOG_FORMAT=default

# ============================================================================
# SECURITY SETTINGS
# ============================================================================

# Anti-spam threshold (messages before action)
PROSODY_SPAM_THRESHOLD=3

# Spam notification recipient
PROSODY_SPAM_NOTIFICATION=admin@example.com

# Failed authentication threshold
PROSODY_FAILED_AUTH_THRESHOLD=5
PROSODY_FAILED_AUTH_WINDOW=300

# Maximum connections per IP
PROSODY_MAX_CONNECTIONS_PER_IP=10

# Firewall rate limiting
PROSODY_FIREWALL_C2S_RATE=10/60
PROSODY_FIREWALL_S2S_RATE=30/60

# ============================================================================
# MESSAGE ARCHIVE MANAGEMENT (MAM)
# ============================================================================

# Archive policy: always, never, roster
PROSODY_ARCHIVE_POLICY=roster

# Archive expiration: 1y, 6m, 90d, etc.
PROSODY_ARCHIVE_EXPIRE=1y

# Maximum results per archive query
PROSODY_ARCHIVE_MAX_RESULTS=50

# ============================================================================
# MULTI-USER CHAT (MUC) SETTINGS
# ============================================================================

# MUC log expiration
PROSODY_MUC_LOG_EXPIRE=1y

# MUC history message count
PROSODY_MUC_HISTORY=50

# Default MUC room visibility
PROSODY_MUC_DEFAULT_PUBLIC=false

# ============================================================================
# HTTP UPLOAD SETTINGS (if PROSODY_ENABLE_HTTP=true)
# ============================================================================

# Maximum file size in bytes (10MB = 10485760)
PROSODY_UPLOAD_SIZE_LIMIT=10485760

# File expiration in seconds (30 days = 2592000)
PROSODY_UPLOAD_EXPIRE=2592000

# ============================================================================
# PORT CONFIGURATION
# ============================================================================

# Client connections (C2S)
PROSODY_C2S_PORT=5222

# Server connections (S2S)
PROSODY_S2S_PORT=5269

# HTTP services (BOSH, WebSocket)
PROSODY_HTTP_PORT=5280

# HTTPS services
PROSODY_HTTPS_PORT=5281

# ============================================================================
# DEPLOYMENT PROFILES
# ============================================================================

# Docker Compose profiles to enable
# Available: sql, cache, monitoring, enterprise
COMPOSE_PROFILES=

# ============================================================================
# EXAMPLE CONFIGURATIONS
# ============================================================================

# Personal Server (1-50 users)
# PROSODY_STORAGE=sqlite
# PROSODY_ENABLE_SECURITY=true
# PROSODY_ENABLE_MODERN=true
# PROSODY_ENABLE_HTTP=false
# PROSODY_C2S_RATE=5kb/s
# PROSODY_C2S_BURST=15kb

# Community Server (50-500 users)
# PROSODY_STORAGE=sql
# PROSODY_ENABLE_SECURITY=true
# PROSODY_ENABLE_MODERN=true
# PROSODY_ENABLE_HTTP=true
# PROSODY_ENABLE_ADMIN=true
# PROSODY_C2S_RATE=10kb/s
# PROSODY_C2S_BURST=25kb
# COMPOSE_PROFILES=sql,cache

# Enterprise Server (500+ users)
# PROSODY_STORAGE=sql
# PROSODY_ENABLE_SECURITY=true
# PROSODY_ENABLE_MODERN=true
# PROSODY_ENABLE_HTTP=true
# PROSODY_ENABLE_ADMIN=true
# PROSODY_ENABLE_ENTERPRISE=true
# PROSODY_C2S_RATE=50kb/s
# PROSODY_C2S_BURST=100kb
# PROSODY_LOG_FORMAT=json
# COMPOSE_PROFILES=sql,cache,monitoring,enterprise 