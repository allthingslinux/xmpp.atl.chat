# ============================================================================
# XMPP SERVER ENVIRONMENT TEMPLATE
# ============================================================================
# Copy this file to create environment-specific files:
# - cp .env.example .env.development  (for local development)
# - cp .env.example .env.production   (for production deployment)
#
# Then edit the copied file with your specific values for each environment.
# DO NOT commit environment-specific files (.env.*) to version control.

# ============================================================================
# ENVIRONMENT TYPE
# ============================================================================
# Set this to match your deployment environment
# Values: development, production
PROSODY_ENV=development

# ============================================================================
# DOMAIN CONFIGURATION
# ============================================================================
# Primary domain for your XMPP server
# Development: localhost or your-dev-domain.com
# Production: your-production-domain.com
PROSODY_DOMAIN=localhost

# Admin email for Let's Encrypt and notifications
PROSODY_ADMIN_EMAIL=admin@localhost

# ============================================================================
# DATABASE CONFIGURATION
# ============================================================================
# Database driver (PostgreSQL recommended)
PROSODY_DB_DRIVER=PostgreSQL

# Database connection details
# Host: Use service name for Docker, hostname for external DB
# Development: xmpp-postgres (Docker) or localhost
# Production: your-db-hostname.com
PROSODY_DB_HOST=xmpp-postgres-dev
PROSODY_DB_PORT=5432
PROSODY_DB_NAME=prosody
PROSODY_DB_USER=prosody
PROSODY_DB_PASSWORD=devpassword

# ============================================================================
# SECURITY SETTINGS
# ============================================================================
# Registration control
PROSODY_ALLOW_REGISTRATION=true

# Encryption requirements
PROSODY_C2S_REQUIRE_ENCRYPTION=false
PROSODY_S2S_REQUIRE_ENCRYPTION=false
PROSODY_S2S_SECURE_AUTH=false

# Connection limits
PROSODY_MAX_CONNECTIONS_PER_IP=10

# Registration throttling
PROSODY_REGISTRATION_THROTTLE_MAX=10
PROSODY_REGISTRATION_THROTTLE_PERIOD=60

# Username validation regex
PROSODY_BLOCK_REGISTRATIONS_REQUIRE=^[a-zA-Z0-9_.-]+$

# TLS security
PROSODY_TLS_CHANNEL_BINDING=false
PROSODY_ALLOW_UNENCRYPTED_PLAIN_AUTH=true

# ============================================================================
# NETWORKING & HTTP
# ============================================================================
# HTTP configuration
PROSODY_HTTP_HOST=localhost
PROSODY_HTTP_SCHEME=http

# TURN/STUN servers for audio/video calls
TURN_SECRET=devsecret
TURN_DOMAIN=localhost
TURN_PORT=3478
TURNS_PORT=5349

# ============================================================================
# SSL CERTIFICATES
# ============================================================================
# Certificate paths (adjust for your domain)
PROSODY_SSL_KEY=certs/live/localhost/privkey.pem
PROSODY_SSL_CERT=certs/live/localhost/fullchain.pem

# ============================================================================
# LOGGING & MONITORING
# ============================================================================
# Log level: debug, info, warn, error
PROSODY_LOG_LEVEL=info

# Statistics collection
PROSODY_STATISTICS=internal
PROSODY_STATISTICS_INTERVAL=manual

# Prometheus/OpenMetrics configuration
PROSODY_OPENMETRICS_IP=127.0.0.1
PROSODY_OPENMETRICS_CIDR=127.0.0.1/32

# ============================================================================
# MESSAGE ARCHIVING (MAM)
# ============================================================================
PROSODY_ARCHIVE_EXPIRES_AFTER=30d
PROSODY_ARCHIVE_POLICY=true
PROSODY_ARCHIVE_COMPRESSION=true
PROSODY_ARCHIVE_STORE=archive
PROSODY_ARCHIVE_MAX_QUERY_RESULTS=250
PROSODY_MAM_SMART_ENABLE=true

# ============================================================================
# MUC (MULTI-USER CHAT) CONFIGURATION
# ============================================================================
PROSODY_MUC_NOTIFICATIONS=true
PROSODY_MUC_OFFLINE_DELIVERY=true
PROSODY_RESTRICT_ROOM_CREATION=false
PROSODY_MUC_DEFAULT_PUBLIC=true
PROSODY_MUC_DEFAULT_PERSISTENT=true
PROSODY_MUC_DEFAULT_PUBLIC_JIDS=true
PROSODY_MUC_LOCKING=false

# MUC Message Archiving
PROSODY_MUC_LOG_BY_DEFAULT=true
PROSODY_MUC_LOG_EXPIRES_AFTER=1y
PROSODY_MUC_LOG_PRESENCES=false
PROSODY_MUC_LOG_ALL_ROOMS=false
PROSODY_MUC_LOG_CLEANUP_INTERVAL=86400
PROSODY_MUC_MAX_ARCHIVE_QUERY_RESULTS=100
PROSODY_MUC_LOG_STORE=muc_log
PROSODY_MUC_LOG_COMPRESSION=true
PROSODY_MUC_MAM_SMART_ENABLE=false

# ============================================================================
# RATE LIMITING
# ============================================================================
# Client-to-server limits
PROSODY_C2S_RATE=10kb/s
PROSODY_C2S_BURST=25kb
PROSODY_C2S_STANZA_SIZE=262144

# Server-to-server limits
PROSODY_S2S_RATE=30kb/s
PROSODY_S2S_BURST=100kb
PROSODY_S2S_STANZA_SIZE=524288

# HTTP upload limits
PROSODY_HTTP_UPLOAD_RATE=2mb/s
PROSODY_HTTP_UPLOAD_BURST=10mb

# ============================================================================
# PUSH NOTIFICATIONS
# ============================================================================
PROSODY_PUSH_IMPORTANT_BODY=New Message!
PROSODY_PUSH_MAX_ERRORS=16
PROSODY_PUSH_MAX_DEVICES=5
PROSODY_PUSH_MAX_HIBERNATION_TIMEOUT=259200
PROSODY_PUSH_NOTIFICATION_WITH_BODY=false
PROSODY_PUSH_NOTIFICATION_WITH_SENDER=false

# ============================================================================
# ACCOUNT MANAGEMENT
# ============================================================================
PROSODY_ACCOUNT_INACTIVE_PERIOD=31536000
PROSODY_ACCOUNT_GRACE_PERIOD=2592000
PROSODY_ACCOUNT_DELETION_CONFIRMATION=true

# ============================================================================
# SERVER INFORMATION
# ============================================================================
PROSODY_SERVER_NAME=localhost
PROSODY_SERVER_WEBSITE=http://localhost
PROSODY_SERVER_DESCRIPTION=XMPP Service

# ============================================================================
# PERFORMANCE & TUNING
# ============================================================================
LUA_GC_STEP_SIZE=13
LUA_GC_PAUSE=110
LUA_GC_SPEED=200
LUA_GC_THRESHOLD=120

# ============================================================================
# COMPONENT URLS
# ============================================================================
PROSODY_UPLOAD_EXTERNAL_URL=http://localhost:5280/upload/
PROSODY_PROXY_ADDRESS=localhost

# ============================================================================
# ADDITIONAL VARIABLES FOR DOCKER/CONTAINERS
# ============================================================================
# PostgreSQL container variables (for docker-compose)
POSTGRES_DB=prosody
POSTGRES_USER=prosody
POSTGRES_PASSWORD=your_secure_password_here

# Development optimizations
POSTGRES_SHARED_BUFFERS=32MB
POSTGRES_EFFECTIVE_CACHE_SIZE=128MB
POSTGRES_WORK_MEM=1MB
POSTGRES_MAINTENANCE_WORK_MEM=16MB
POSTGRES_CHECKPOINT_COMPLETION_TARGET=0.9
POSTGRES_WAL_BUFFERS=4MB
POSTGRES_DEFAULT_STATISTICS_TARGET=50
POSTGRES_RANDOM_PAGE_COST=1.1
POSTGRES_EFFECTIVE_IO_CONCURRENCY=100

# ============================================================================
# NGINX REVERSE PROXY VARIABLES
# ============================================================================
NGINX_HTTP_PORT=80
NGINX_HTTPS_PORT=443

# ============================================================================
# ADMINER DATABASE MANAGEMENT VARIABLES
# ============================================================================
ADMINER_PORT=8080
ADMINER_AUTO_LOGIN=false
ADMINER_DEFAULT_DRIVER=pgsql
ADMINER_DEFAULT_SERVER=xmpp-postgres
ADMINER_DEFAULT_DB=prosody
ADMINER_DEFAULT_USERNAME=prosody
ADMINER_DEFAULT_PASSWORD=your_secure_password_here

# ============================================================================
# LETSENCRYPT/CERTBOT VARIABLES
# ============================================================================
LETSENCRYPT_EMAIL=admin@example.com
